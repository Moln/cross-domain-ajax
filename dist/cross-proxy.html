<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Cross proxy</title>
  </head>
  <body>
  <script type="text/javascript">!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){n(3).onVerifyOrigin(function(e){if(console.log(e),!/localhost:8080$/.test(e))throw new Error("Invalid origin "+e)})},,function(module,exports,__webpack_require__){!function(e,t,n){module.exports=n(t)}(0,window,function(window){"use strict";window.JSON||(window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(e){var t=function(e){return e.replace(/"/g,"\\$&").replace(/\n/g,"\\n")};if(e instanceof Object){var n="";if(e.constructor===Array){for(var r=0;r<e.length;n+=this.stringify(e[r])+",",r++);return"["+n.substr(0,n.length-1)+"]"}if(e.toString!==Object.prototype.toString)return'"'+t(e.toString())+'"';for(var o in e)n+='"'+t(o)+'":'+this.stringify(e[o])+",";return"{"+n.substr(0,n.length-1)+"}"}if("unknown"==typeof e)return'"[unknown]"';if("string"==typeof e)return'"'+t(e)+'"';try{return this.parse(String(e)),String(e)}catch(s){return e.toString?'"'+String(e)+'"':'"['+typeof e+']"'}}});var extend=function(){for(var e=arguments[0],t=1,n=arguments.length;t<n;t++){var r=arguments[t];for(var o in r)e[o]=r[o]}return e},handlers={postMessage:function(){var e=function(e){var t=window.JSON.parse(e.data);t.type&&pm.trigger({data:t,origin:e.origin,source:e.source})};this.send=function(e,t,n){t=window.JSON.stringify(t),e.postMessage(t,n)},window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent&&window.attachEvent("onmessage",e)},opener:function(){var e=window.location.protocol+"//"+window.location.host,t=[],n=function(t){try{return void(t.source.window.document&&t.source.window.document!=document&&(t.source.window.document.domain="unknownhost",console.warn("Error document, not real.")))}catch(n){}"*"!=t.origin&&t.origin.replace(/\//g,"")!=e.replace(/\//g,"")||pm.trigger({data:window.JSON.parse(t.data),origin:t.source.origin,source:t.source.window})};setInterval(function(){if(window.opener&&window.opener.postMessage)for(var e=window.opener.postMessage,t=0;t<e.length;)e[t].target==window?n(e.splice(t,1)[0]):t++},100);this.send=function(n,r,o){t.push({source:{window:window,origin:e},data:window.JSON.stringify(r),origin:o,target:n});try{n.opener={postMessage:t}}catch(s){console.warn('Target not support "opener.postMessage";'+s.message)}}},hash:function(){}},handler=new handlers[window.postMessage?"postMessage":"opener"],events={},eventTick=0,pm={handler:handler,defaults:{target:null,type:null,data:null,callback:null,complete:null,origin:"*"},send:function(e,t,n,r){var o={};o="object"==typeof e?e:extend({type:e,target:t,data:n},r);var s=extend({},pm.defaults,o),a=s.target,i=++eventTick;if(!s.target||!s.type)throw new Error("Arguments [target,type] required");return s.callback&&this.bind("postMessage.callback."+i,function(e){e.source==s.target&&s.callback.apply(e,e.data)},!0),s.complete&&this.bind("postMessage.complete."+i,function(e){e.source==s.target&&s.complete.call(e,e.data)},!0),handler.send(a,{data:s.data,type:s.type,callback:!!s.callback,complete:!!s.complete,id:i},s.origin||"*"),i},bind:function(e,t,n){events[e]=events[e]||[],events[e].push([function(e){var n=e.data,r=t.call(this,{data:n,source:e.source,origin:e.origin,callback:function(){e.callback&&handler.send(e.source,{data:Array.prototype.slice.call(arguments),type:"postMessage.callback."+e.id},e.origin)}});e.complete&&handler.send(e.source,{data:r,type:"postMessage.complete."+e.id},e.origin)},n])},one:function(e,t){this.bind(e,t,!0)},trigger:function(e){if(e.data.origin=e.origin,e.data.source=e.source,events[e.data.type])for(var t=0;t<events[e.data.type].length;t++)events[e.data.type][t][0](e.data),events[e.data.type][t][1]&&events[e.data.type].splice(t,1)}};return pm})},function(e,t,n){var r=n(2),o=n(4),s=function(){var e,t,n,r=arguments[0]||{},o=1,s=arguments.length;for("object"!=typeof r&&(r={});o<s;o++)if(null!=(e=arguments[o]))for(t in e)r[t],r!==(n=e[t])&&(r[t]=n);return r},a=function(e){var t={};for(var n in e)"function"!=typeof e[n]&&(t[n]=e[n]);return t},i=function(e){var t;(t=e.getResponseHeader("Content-Type"))&&/application\/([\w\b]*)json([\w\b]*)/.test(t)&&(e.responseJSON=window.JSON.parse(e.responseText))},c=function(){};r.bind("cross-ajax",function(e){c(e.origin),console.log("verifyOrigin",c);var t=e.data;o(s(t,{headers:{"X-Referer":document.referrer},success:function(e,t){i(t),r.send({target:window.parent,type:"cross-ajax.success",data:e})},error:function(e){i(e),r.send({target:window.parent,type:"cross-ajax.error",data:e})},complete:function(t){i(t);var n=t.status>=200&&t.status<300?"success":"error";e.callback(n,a(t)),r.send({target:window.parent,type:"cross-ajax.complete",data:t})}}))}),e.exports={onVerifyOrigin:function(e){c=e}}},function(e,t,n){var r=n(5);e.exports=window.ajax=function(e){var t={url:!1,type:"GET",data:"",contentType:"application/x-www-form-urlencoded",async:!0,success:function(e){},error:function(e){},charset:"UTF-8"};for(var n in t)e[n]===undefined&&(e[n]=t[n]);e.url||alert("Url not empty!");var o;return this.httpRequest=function(){if("undefined"!=typeof XMLHttpRequest)o=new XMLHttpRequest;else if(window.ActiveXObject)for(var e=["Msxml2.XMLHttp.5.0","Msxml2.XMLHttp.4.0","Msxml2.XMLHttp.3.0","Msxml2.XMLHttp","Microsoft.XMLHttp"],t=0;t<e.length;t++)try{o=new ActiveXObject(e[t]);break}catch(n){}o?this.initReq():alert("Your browser does not permit the use of all of this application's features!")},this.initReq=function(){if(o.open(e.type,e.url,e.async),o.setRequestHeader("Content-Type",e.contentType+"; charset="+e.charset),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.headers)for(var t in e.headers)o.setRequestHeader(t,e.headers[t]);try{o.send(r(e.data))}catch(n){return!1}return o.onreadystatechange=this.handleResponse,!0},this.handleResponse=function(){4==o.readyState&&(o.status>=200&&o.status<300?e.success(o.responseText,o):e.error(o),e.complete&&e.complete(o))},this.httpRequest(),e.async||(o.status>=200&&o<300?e.success(o.responseText):e.error(o)),o}},function(e,t){e.exports=function(e){var t="";if("string"==typeof e)t=e;else if(e instanceof window.Array){for(n=0;n<e.length;n++)t+="&"+encodeURIComponent(e[n].name)+"="+encodeURIComponent(e[n].value);t=t.substr(1)}else if("object"==typeof e){for(var n in e)t+="&"+encodeURIComponent(n)+"="+encodeURIComponent(e[n]);t=t.substr(1)}return t}}])})</script></body>
</html>